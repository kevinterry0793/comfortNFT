{"ast":null,"code":"import _objectSpread from\"/Users/hienle/Documents/GitHub/comfortNFT/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"/Users/hienle/Documents/GitHub/comfortNFT/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/hienle/Documents/GitHub/comfortNFT/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import{ethers}from\"ethers\";import Web3 from\"web3\";import BigNumber from\"bignumber.js\";BigNumber.config({EXPONENTIAL_AT:1000,DECIMAL_PLACES:80});var GAS_LIMIT={STAKING:{DEFAULT:400000,SNX:850000}};var knownSnapshots={\"0x110f2263e5adf63ea82514bbec3440762edefed1bdf4f0ee06a9458fc3e7e2e7\":\"https://snapshot.page/#/yamv2/proposal/QmTCXW2bhETiwHoDqeyxoDA4CwjURyfc6T4fAJLGz3yKj9\",\"0xad13b6cc77c781ee81529b3bcac2c2e81f588eede376fc9b2c75879cd20ffdc7\":\"https://snapshot.page/#/yam/proposal/QmVzvqJwnnEhnJGxDoKZNNkeRXvrmscrhwpLbZrQxw1mkf\",\"0xd00307c2982b4fba5790f238ff8df9faab975794dd4144eddbd30ac67eb873ed\":\"https://snapshot.page/#/yam/proposal/QmQxMTQkz7fW3AXma69ueEwhq5Sf8HNdUYseEFQFw3uKEx\"};export var getPoolStartTime=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(poolContract){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return poolContract.methods.starttime().call();case 2:return _context.abrupt(\"return\",_context.sent);case 3:case\"end\":return _context.stop();}}},_callee);}));return function getPoolStartTime(_x){return _ref.apply(this,arguments);};}();export var stake=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(poolContract,provider,poolId,amount,account,onTxHash){var now,gas;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:now=new Date().getTime()/1000;// const gas = GAS_LIMIT.STAKING[tokenName.toUpperCase()] || GAS_LIMIT.STAKING.DEFAULT;\ngas=GAS_LIMIT.STAKING.DEFAULT;if(!(now>=1597172400)){_context3.next=6;break;}return _context3.abrupt(\"return\",poolContract.methods.stake(String(new BigNumber(amount).times(new BigNumber(10).pow(18))),String(new BigNumber(poolId))).send({from:account,gas:400000},/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(error,txHash){var status;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!error){_context2.next=4;break;}onTxHash&&onTxHash(\"\");console.log(\"Staking error\",error);return _context2.abrupt(\"return\",false);case 4:onTxHash&&onTxHash(txHash);_context2.next=7;return waitTransaction(provider,txHash);case 7:status=_context2.sent;if(status){_context2.next=11;break;}console.log(\"Staking transaction failed.\");return _context2.abrupt(\"return\",false);case 11:return _context2.abrupt(\"return\",true);case 12:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x8,_x9){return _ref3.apply(this,arguments);};}()));case 6:alert(\"pool not active\");case 7:case\"end\":return _context3.stop();}}},_callee3);}));return function stake(_x2,_x3,_x4,_x5,_x6,_x7){return _ref2.apply(this,arguments);};}();export var unstake=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(poolContract,provider,poolId,amount,account,onTxHash){var now;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:now=new Date().getTime()/1000;if(!(now>=1597172400)){_context5.next=5;break;}return _context5.abrupt(\"return\",poolContract.methods.withdraw(String(new BigNumber(amount).times(new BigNumber(10).pow(18))),String(new BigNumber(poolId))).send({from:account,gas:600000},/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(error,txHash){var status;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:if(!error){_context4.next=4;break;}onTxHash&&onTxHash(\"\");console.log(\"Unstaking error\",error);return _context4.abrupt(\"return\",false);case 4:onTxHash&&onTxHash(txHash);_context4.next=7;return waitTransaction(provider,txHash);case 7:status=_context4.sent;if(status){_context4.next=11;break;}console.log(\"Unstaking transaction failed.\");return _context4.abrupt(\"return\",false);case 11:return _context4.abrupt(\"return\",true);case 12:case\"end\":return _context4.stop();}}},_callee4);}));return function(_x16,_x17){return _ref5.apply(this,arguments);};}()));case 5:alert(\"pool not active\");case 6:case\"end\":return _context5.stop();}}},_callee5);}));return function unstake(_x10,_x11,_x12,_x13,_x14,_x15){return _ref4.apply(this,arguments);};}();export var harvest=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee7(poolContract,provider,account,onTxHash){return _regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:return _context7.abrupt(\"return\",poolContract.methods.getReward().send({from:account,gas:800000},/*#__PURE__*/function(){var _ref7=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(error,txHash){var status;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:if(!error){_context6.next=4;break;}onTxHash&&onTxHash(\"\");console.log(\"Claim error\",error);return _context6.abrupt(\"return\",false);case 4:onTxHash&&onTxHash(txHash);_context6.next=7;return waitTransaction(provider,txHash);case 7:status=_context6.sent;if(status){_context6.next=11;break;}console.log(\"Claim transaction failed.\");return _context6.abrupt(\"return\",false);case 11:return _context6.abrupt(\"return\",true);case 12:case\"end\":return _context6.stop();}}},_callee6);}));return function(_x22,_x23){return _ref7.apply(this,arguments);};}()));case 1:case\"end\":return _context7.stop();}}},_callee7);}));return function harvest(_x18,_x19,_x20,_x21){return _ref6.apply(this,arguments);};}();export var harvestNfts=/*#__PURE__*/function(){var _ref8=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee9(poolContract,provider,account,nftids,onTxHash){return _regeneratorRuntime.wrap(function _callee9$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:console.log(\"getRewards nftids\",nftids);return _context9.abrupt(\"return\",poolContract.methods.getReward(nftids).send({from:account,gas:800000},/*#__PURE__*/function(){var _ref9=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee8(error,txHash){var status;return _regeneratorRuntime.wrap(function _callee8$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:if(!error){_context8.next=4;break;}onTxHash&&onTxHash(\"\");console.log(\"Claim error\",error);return _context8.abrupt(\"return\",false);case 4:onTxHash&&onTxHash(txHash);_context8.next=7;return waitTransaction(provider,txHash);case 7:status=_context8.sent;if(status){_context8.next=11;break;}console.log(\"Claim transaction failed.\");return _context8.abrupt(\"return\",false);case 11:return _context8.abrupt(\"return\",true);case 12:case\"end\":return _context8.stop();}}},_callee8);}));return function(_x29,_x30){return _ref9.apply(this,arguments);};}()));case 2:case\"end\":return _context9.stop();}}},_callee9);}));return function harvestNfts(_x24,_x25,_x26,_x27,_x28){return _ref8.apply(this,arguments);};}();export var redeem=/*#__PURE__*/function(){var _ref10=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee11(poolContract,provider,poolId,account,onTxHash){var now;return _regeneratorRuntime.wrap(function _callee11$(_context11){while(1){switch(_context11.prev=_context11.next){case 0:now=new Date().getTime()/1000;if(!(now>=1597172400)){_context11.next=5;break;}return _context11.abrupt(\"return\",poolContract.methods.exit(String(new BigNumber(poolId))).send({from:account,gas:400000},/*#__PURE__*/function(){var _ref11=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee10(error,txHash){var status;return _regeneratorRuntime.wrap(function _callee10$(_context10){while(1){switch(_context10.prev=_context10.next){case 0:if(!error){_context10.next=4;break;}onTxHash&&onTxHash(\"\");console.log(\"Redeem error\",error);return _context10.abrupt(\"return\",false);case 4:onTxHash&&onTxHash(txHash);_context10.next=7;return waitTransaction(provider,txHash);case 7:status=_context10.sent;if(status){_context10.next=11;break;}console.log(\"Redeem transaction failed.\");return _context10.abrupt(\"return\",false);case 11:return _context10.abrupt(\"return\",true);case 12:case\"end\":return _context10.stop();}}},_callee10);}));return function(_x36,_x37){return _ref11.apply(this,arguments);};}()));case 5:alert(\"pool not active\");case 6:case\"end\":return _context11.stop();}}},_callee11);}));return function redeem(_x31,_x32,_x33,_x34,_x35){return _ref10.apply(this,arguments);};}();export var singleExit=/*#__PURE__*/function(){var _ref12=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee13(poolContract,provider,amount,account,onTxHash){return _regeneratorRuntime.wrap(function _callee13$(_context13){while(1){switch(_context13.prev=_context13.next){case 0:return _context13.abrupt(\"return\",poolContract.methods.exit(String(new BigNumber(amount).times(new BigNumber(10).pow(18)))).send({from:account,gas:400000},/*#__PURE__*/function(){var _ref13=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee12(error,txHash){var status;return _regeneratorRuntime.wrap(function _callee12$(_context12){while(1){switch(_context12.prev=_context12.next){case 0:if(!error){_context12.next=4;break;}onTxHash&&onTxHash(\"\");console.log(\"Redeem error\",error);return _context12.abrupt(\"return\",false);case 4:onTxHash&&onTxHash(txHash);_context12.next=7;return waitTransaction(provider,txHash);case 7:status=_context12.sent;if(status){_context12.next=11;break;}console.log(\"Redeem transaction failed.\");return _context12.abrupt(\"return\",false);case 11:return _context12.abrupt(\"return\",true);case 12:case\"end\":return _context12.stop();}}},_callee12);}));return function(_x43,_x44){return _ref13.apply(this,arguments);};}()));case 1:case\"end\":return _context13.stop();}}},_callee13);}));return function singleExit(_x38,_x39,_x40,_x41,_x42){return _ref12.apply(this,arguments);};}();export var approve=/*#__PURE__*/function(){var _ref14=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee14(tokenContract,poolContract,account){return _regeneratorRuntime.wrap(function _callee14$(_context14){while(1){switch(_context14.prev=_context14.next){case 0:return _context14.abrupt(\"return\",tokenContract.methods.approve(poolContract.options.address,String(ethers.constants.MaxUint256)).send({from:account,gas:80000}));case 1:case\"end\":return _context14.stop();}}},_callee14);}));return function approve(_x45,_x46,_x47){return _ref14.apply(this,arguments);};}();export var getPoolContracts=/*#__PURE__*/function(){var _ref15=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee15(yam){var pools;return _regeneratorRuntime.wrap(function _callee15$(_context15){while(1){switch(_context15.prev=_context15.next){case 0:pools=Object.keys(yam.contracts).filter(function(c){return c.indexOf(\"_pool\")!==-1;}).reduce(function(acc,cur){var newAcc=_objectSpread({},acc);newAcc[cur]=yam.contracts[cur];return newAcc;},{});return _context15.abrupt(\"return\",pools);case 2:case\"end\":return _context15.stop();}}},_callee15);}));return function getPoolContracts(_x48){return _ref15.apply(this,arguments);};}();export var getSingleStakeBalances=/*#__PURE__*/function(){var _ref16=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee16(pool,account){var stakes;return _regeneratorRuntime.wrap(function _callee16$(_context16){while(1){switch(_context16.prev=_context16.next){case 0:stakes=[];_context16.prev=1;_context16.next=4;return pool.methods.getStakes(account).call();case 4:stakes=_context16.sent;_context16.next=10;break;case 7:_context16.prev=7;_context16.t0=_context16[\"catch\"](1);console.error(\"can not get user stakes\",_context16.t0);case 10:return _context16.abrupt(\"return\",stakes);case 11:case\"end\":return _context16.stop();}}},_callee16,null,[[1,7]]);}));return function getSingleStakeBalances(_x49,_x50){return _ref16.apply(this,arguments);};}();export var getExitableAmount=/*#__PURE__*/function(){var _ref17=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee17(pool,account){var amount;return _regeneratorRuntime.wrap(function _callee17$(_context17){while(1){switch(_context17.prev=_context17.next){case 0:amount=new BigNumber(0);_context17.prev=1;_context17.next=4;return pool.methods.exitableAmount(account).call();case 4:amount=_context17.sent;_context17.next=10;break;case 7:_context17.prev=7;_context17.t0=_context17[\"catch\"](1);console.error(\"can not get exitable amount\",_context17.t0);case 10:return _context17.abrupt(\"return\",amount);case 11:case\"end\":return _context17.stop();}}},_callee17,null,[[1,7]]);}));return function getExitableAmount(_x51,_x52){return _ref17.apply(this,arguments);};}();export var getSingleStakingEndTime=/*#__PURE__*/function(){var _ref18=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee18(yam,pool){var endTime;return _regeneratorRuntime.wrap(function _callee18$(_context18){while(1){switch(_context18.prev=_context18.next){case 0:_context18.next=2;return pool.methods.endTime().call();case 2:endTime=_context18.sent;return _context18.abrupt(\"return\",yam.toBigN(endTime||0));case 4:case\"end\":return _context18.stop();}}},_callee18);}));return function getSingleStakingEndTime(_x53,_x54){return _ref18.apply(this,arguments);};}();export var stxpSingleRedeem=/*#__PURE__*/function(){var _ref19=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee20(poolContract,provider,amount,account,onTxHash){return _regeneratorRuntime.wrap(function _callee20$(_context20){while(1){switch(_context20.prev=_context20.next){case 0:return _context20.abrupt(\"return\",poolContract.methods.exit(String(amount)).send({from:account,gas:400000},/*#__PURE__*/function(){var _ref20=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee19(error,txHash){var status;return _regeneratorRuntime.wrap(function _callee19$(_context19){while(1){switch(_context19.prev=_context19.next){case 0:if(!error){_context19.next=4;break;}onTxHash&&onTxHash(\"\");console.log(\"Redeem error\",error);return _context19.abrupt(\"return\",false);case 4:onTxHash&&onTxHash(txHash);_context19.next=7;return waitTransaction(provider,txHash);case 7:status=_context19.sent;if(status){_context19.next=11;break;}console.log(\"Redeem transaction failed.\");return _context19.abrupt(\"return\",false);case 11:return _context19.abrupt(\"return\",true);case 12:case\"end\":return _context19.stop();}}},_callee19);}));return function(_x60,_x61){return _ref20.apply(this,arguments);};}()));case 1:case\"end\":return _context20.stop();}}},_callee20);}));return function stxpSingleRedeem(_x55,_x56,_x57,_x58,_x59){return _ref19.apply(this,arguments);};}();export var stxpSingleHarvest=/*#__PURE__*/function(){var _ref21=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee22(poolContract,provider,account,onTxHash){return _regeneratorRuntime.wrap(function _callee22$(_context22){while(1){switch(_context22.prev=_context22.next){case 0:return _context22.abrupt(\"return\",poolContract.methods.redeem().send({from:account,gas:400000},/*#__PURE__*/function(){var _ref22=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee21(error,txHash){var status;return _regeneratorRuntime.wrap(function _callee21$(_context21){while(1){switch(_context21.prev=_context21.next){case 0:if(!error){_context21.next=4;break;}onTxHash&&onTxHash(\"\");console.log(\"Redeem error\",error);return _context21.abrupt(\"return\",false);case 4:onTxHash&&onTxHash(txHash);_context21.next=7;return waitTransaction(provider,txHash);case 7:status=_context21.sent;if(status){_context21.next=11;break;}console.log(\"Redeem transaction failed.\");return _context21.abrupt(\"return\",false);case 11:return _context21.abrupt(\"return\",true);case 12:case\"end\":return _context21.stop();}}},_callee21);}));return function(_x66,_x67){return _ref22.apply(this,arguments);};}()));case 1:case\"end\":return _context22.stop();}}},_callee22);}));return function stxpSingleHarvest(_x62,_x63,_x64,_x65){return _ref21.apply(this,arguments);};}();export var stxpSingleStake=/*#__PURE__*/function(){var _ref23=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee24(poolContract,provider,duration,amount,account,onTxHash){return _regeneratorRuntime.wrap(function _callee24$(_context24){while(1){switch(_context24.prev=_context24.next){case 0:return _context24.abrupt(\"return\",poolContract.methods.stake(String(new BigNumber(amount).times(new BigNumber(10).pow(18))),duration).send({from:account,gas:400000},/*#__PURE__*/function(){var _ref24=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee23(error,txHash){var status;return _regeneratorRuntime.wrap(function _callee23$(_context23){while(1){switch(_context23.prev=_context23.next){case 0:if(!error){_context23.next=4;break;}onTxHash&&onTxHash(\"\");console.log(\"Staking error\",error);return _context23.abrupt(\"return\",false);case 4:onTxHash&&onTxHash(txHash);_context23.next=7;return waitTransaction(provider,txHash);case 7:status=_context23.sent;if(status){_context23.next=11;break;}console.log(\"Staking transaction failed.\");return _context23.abrupt(\"return\",false);case 11:return _context23.abrupt(\"return\",true);case 12:case\"end\":return _context23.stop();}}},_callee23);}));return function(_x74,_x75){return _ref24.apply(this,arguments);};}()));case 1:case\"end\":return _context24.stop();}}},_callee24);}));return function stxpSingleStake(_x68,_x69,_x70,_x71,_x72,_x73){return _ref23.apply(this,arguments);};}();export var generateNft=/*#__PURE__*/function(){var _ref25=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee26(poolContract,provider,poolId,amount,name,account,onTxHash){return _regeneratorRuntime.wrap(function _callee26$(_context26){while(1){switch(_context26.prev=_context26.next){case 0:console.log(\"create NFT\",String(poolId),String(new BigNumber(amount).times(new BigNumber(10).pow(18))),name);return _context26.abrupt(\"return\",poolContract.methods.craftStrainNFT(String(poolId),String(new BigNumber(amount).times(new BigNumber(10).pow(18))),name).send({from:account,gas:1300000},/*#__PURE__*/function(){var _ref26=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee25(error,txHash){var status;return _regeneratorRuntime.wrap(function _callee25$(_context25){while(1){switch(_context25.prev=_context25.next){case 0:if(!error){_context25.next=4;break;}onTxHash&&onTxHash(\"\");console.log(\"create NFT error\",error);return _context25.abrupt(\"return\",false);case 4:onTxHash&&onTxHash(txHash);_context25.next=7;return waitTransaction(provider,txHash);case 7:status=_context25.sent;if(status){_context25.next=11;break;}console.log(\"Creating NFT transaction failed.\");return _context25.abrupt(\"return\",false);case 11:return _context25.abrupt(\"return\",true);case 12:case\"end\":return _context25.stop();}}},_callee25);}));return function(_x83,_x84){return _ref26.apply(this,arguments);};}()));case 2:case\"end\":return _context26.stop();}}},_callee26);}));return function generateNft(_x76,_x77,_x78,_x79,_x80,_x81,_x82){return _ref25.apply(this,arguments);};}();export var addNftStake=/*#__PURE__*/function(){var _ref27=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee28(poolContract,provider,poolId,nftId,amount,stxpTokens,account,onTxHash){var lpAmount,stxpAmount;return _regeneratorRuntime.wrap(function _callee28$(_context28){while(1){switch(_context28.prev=_context28.next){case 0:console.log(\"add stake to NFT\",String(poolId),amount,stxpTokens);lpAmount=String(new BigNumber(amount).times(new BigNumber(10).pow(18)));stxpAmount=String(new BigNumber(stxpTokens).times(new BigNumber(10).pow(18)));return _context28.abrupt(\"return\",poolContract.methods.stake(String(poolId),nftId,lpAmount,stxpAmount).send({from:account,gas:1300000},/*#__PURE__*/function(){var _ref28=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee27(error,txHash){var status;return _regeneratorRuntime.wrap(function _callee27$(_context27){while(1){switch(_context27.prev=_context27.next){case 0:if(!error){_context27.next=4;break;}onTxHash&&onTxHash(\"\");console.log(\"create NFT error\",error);return _context27.abrupt(\"return\",false);case 4:onTxHash&&onTxHash(txHash);_context27.next=7;return waitTransaction(provider,txHash);case 7:status=_context27.sent;if(status){_context27.next=11;break;}console.log(\"Creating NFT transaction failed.\");return _context27.abrupt(\"return\",false);case 11:return _context27.abrupt(\"return\",true);case 12:case\"end\":return _context27.stop();}}},_callee27);}));return function(_x93,_x94){return _ref28.apply(this,arguments);};}()));case 4:case\"end\":return _context28.stop();}}},_callee28);}));return function addNftStake(_x85,_x86,_x87,_x88,_x89,_x90,_x91,_x92){return _ref27.apply(this,arguments);};}();export var burnNft=/*#__PURE__*/function(){var _ref29=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee30(poolContract,provider,nftId,poolId,account,onTxHash){return _regeneratorRuntime.wrap(function _callee30$(_context30){while(1){switch(_context30.prev=_context30.next){case 0:return _context30.abrupt(\"return\",poolContract.methods.burn(String(nftId),String(poolId)).send({from:account,gas:400000},/*#__PURE__*/function(){var _ref30=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee29(error,txHash){var status;return _regeneratorRuntime.wrap(function _callee29$(_context29){while(1){switch(_context29.prev=_context29.next){case 0:if(!error){_context29.next=4;break;}onTxHash&&onTxHash(\"\");console.log(\"burn NFT error\",error);return _context29.abrupt(\"return\",false);case 4:onTxHash&&onTxHash(txHash);_context29.next=7;return waitTransaction(provider,txHash);case 7:status=_context29.sent;if(status){_context29.next=11;break;}console.log(\"Destroying NFT transaction failed.\");return _context29.abrupt(\"return\",false);case 11:return _context29.abrupt(\"return\",true);case 12:case\"end\":return _context29.stop();}}},_callee29);}));return function(_x101,_x102){return _ref30.apply(this,arguments);};}()));case 1:case\"end\":return _context30.stop();}}},_callee30);}));return function burnNft(_x95,_x96,_x97,_x98,_x99,_x100){return _ref29.apply(this,arguments);};}();export var breedNfts=/*#__PURE__*/function(){var _ref31=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee32(crafterContract,provider,poolId,amount,stxpAmount,stxpBurnAmount,name,parentOne,parentTwo,account,onTxHash){return _regeneratorRuntime.wrap(function _callee32$(_context32){while(1){switch(_context32.prev=_context32.next){case 0:console.log(\"breading NFTs\",String(poolId),String(new BigNumber(amount).times(new BigNumber(10).pow(18))),String(new BigNumber(stxpAmount).times(new BigNumber(10).pow(18))),String(new BigNumber(stxpBurnAmount).times(new BigNumber(10).pow(18))),name);return _context32.abrupt(\"return\",crafterContract.methods.breedStrainNFT(String(poolId),String(new BigNumber(amount).times(new BigNumber(10).pow(18))),String(new BigNumber(stxpAmount).times(new BigNumber(10).pow(18))),String(new BigNumber(stxpBurnAmount).times(new BigNumber(10).pow(18))),name,String(parentOne),String(parentTwo)).send({from:account,gas:1300000},/*#__PURE__*/function(){var _ref32=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee31(error,txHash){var status;return _regeneratorRuntime.wrap(function _callee31$(_context31){while(1){switch(_context31.prev=_context31.next){case 0:if(!error){_context31.next=4;break;}onTxHash&&onTxHash(\"\");console.log(\"breeding NFTs error\",error);return _context31.abrupt(\"return\",false);case 4:onTxHash&&onTxHash(txHash);_context31.next=7;return waitTransaction(provider,txHash);case 7:status=_context31.sent;if(status){_context31.next=11;break;}console.log(\"Breeding NFT transaction failed.\");return _context31.abrupt(\"return\",false);case 11:return _context31.abrupt(\"return\",true);case 12:case\"end\":return _context31.stop();}}},_callee31);}));return function(_x114,_x115){return _ref32.apply(this,arguments);};}()));case 2:case\"end\":return _context32.stop();}}},_callee32);}));return function breedNfts(_x103,_x104,_x105,_x106,_x107,_x108,_x109,_x110,_x111,_x112,_x113){return _ref31.apply(this,arguments);};}();export var getSingleEarned=/*#__PURE__*/function(){var _ref33=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee33(yam,pool,account){return _regeneratorRuntime.wrap(function _callee33$(_context33){while(1){switch(_context33.prev=_context33.next){case 0:_context33.t0=yam;_context33.next=3;return pool.methods.withdrawableRewards(account).call();case 3:_context33.t1=_context33.sent;return _context33.abrupt(\"return\",_context33.t0.toBigN.call(_context33.t0,_context33.t1));case 5:case\"end\":return _context33.stop();}}},_callee33);}));return function getSingleEarned(_x116,_x117,_x118){return _ref33.apply(this,arguments);};}();export var getEarned=/*#__PURE__*/function(){var _ref34=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee34(yam,pool,account){return _regeneratorRuntime.wrap(function _callee34$(_context34){while(1){switch(_context34.prev=_context34.next){case 0:_context34.t0=yam;_context34.next=3;return pool.methods.earned(account).call();case 3:_context34.t1=_context34.sent;return _context34.abrupt(\"return\",_context34.t0.toBigN.call(_context34.t0,_context34.t1));case 5:case\"end\":return _context34.stop();}}},_callee34);}));return function getEarned(_x119,_x120,_x121){return _ref34.apply(this,arguments);};}();export var getNftEarned=/*#__PURE__*/function(){var _ref35=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee35(yam,crafter,account,nftid){return _regeneratorRuntime.wrap(function _callee35$(_context35){while(1){switch(_context35.prev=_context35.next){case 0:_context35.t0=yam;_context35.next=3;return crafter.methods.earned(account,nftid).call();case 3:_context35.t1=_context35.sent;return _context35.abrupt(\"return\",_context35.t0.toBigN.call(_context35.t0,_context35.t1));case 5:case\"end\":return _context35.stop();}}},_callee35);}));return function getNftEarned(_x122,_x123,_x124,_x125){return _ref35.apply(this,arguments);};}();export var getCanBreed=/*#__PURE__*/function(){var _ref36=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee36(crafter,nftId1,nftId2){return _regeneratorRuntime.wrap(function _callee36$(_context36){while(1){switch(_context36.prev=_context36.next){case 0:_context36.next=2;return crafter.methods.canBreed(nftId1,nftId2).call();case 2:return _context36.abrupt(\"return\",_context36.sent);case 3:case\"end\":return _context36.stop();}}},_callee36);}));return function getCanBreed(_x126,_x127,_x128){return _ref36.apply(this,arguments);};}();export var getStaked=/*#__PURE__*/function(){var _ref37=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee37(yam,pool,account){return _regeneratorRuntime.wrap(function _callee37$(_context37){while(1){switch(_context37.prev=_context37.next){case 0:_context37.t0=yam;_context37.next=3;return pool.methods.balanceOf(account).call();case 3:_context37.t1=_context37.sent;return _context37.abrupt(\"return\",_context37.t0.toBigN.call(_context37.t0,_context37.t1));case 5:case\"end\":return _context37.stop();}}},_callee37);}));return function getStaked(_x129,_x130,_x131){return _ref37.apply(this,arguments);};}();export var getCurrentPrice=/*#__PURE__*/function(){var _ref38=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee38(yam){return _regeneratorRuntime.wrap(function _callee38$(_context38){while(1){switch(_context38.prev=_context38.next){case 0:_context38.t0=BigNumber;_context38.next=3;return yam.contracts.rebaser.methods.getCurrentTWAP().call();case 3:_context38.t1=_context38.sent;return _context38.abrupt(\"return\",new _context38.t0(_context38.t1));case 5:case\"end\":return _context38.stop();}}},_callee38);}));return function getCurrentPrice(_x132){return _ref38.apply(this,arguments);};}();export var getTargetPrice=/*#__PURE__*/function(){var _ref39=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee39(yam){return _regeneratorRuntime.wrap(function _callee39$(_context39){while(1){switch(_context39.prev=_context39.next){case 0:return _context39.abrupt(\"return\",yam.toBigN(1).toFixed(2));case 1:case\"end\":return _context39.stop();}}},_callee39);}));return function getTargetPrice(_x133){return _ref39.apply(this,arguments);};}();export var getCirculatingSupply=/*#__PURE__*/function(){var _ref40=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee40(yam){var now,scalingFactor,starttime,timePassed,yamsDistributed,starttimePool2,pool2Yams,circulating;return _regeneratorRuntime.wrap(function _callee40$(_context40){while(1){switch(_context40.prev=_context40.next){case 0:_context40.next=2;return yam.web3.eth.getBlock(\"latest\");case 2:now=_context40.sent;_context40.t0=yam;_context40.next=6;return yam.contracts.yamV3.methods.yamsScalingFactor().call();case 6:_context40.t1=_context40.sent;scalingFactor=_context40.t0.toBigN.call(_context40.t0,_context40.t1);_context40.t2=yam;_context40.next=11;return yam.contracts.eth_pool.methods.starttime().call();case 11:_context40.t3=_context40.sent;starttime=_context40.t2.toBigN.call(_context40.t2,_context40.t3).toNumber();timePassed=now[\"timestamp\"]-starttime;if(!(timePassed<0)){_context40.next=16;break;}return _context40.abrupt(\"return\",0);case 16:yamsDistributed=yam.toBigN(8*timePassed*250000/625000);//yams from first 8 pools\n_context40.t4=yam;_context40.next=20;return yam.contracts.ycrv_pool.methods.starttime().call();case 20:_context40.t5=_context40.sent;starttimePool2=_context40.t4.toBigN.call(_context40.t4,_context40.t5).toNumber();timePassed=now[\"timestamp\"]-starttime;pool2Yams=yam.toBigN(timePassed*1500000/625000);// yams from second pool. note: just accounts for first week\ncirculating=pool2Yams.plus(yamsDistributed).times(scalingFactor).dividedBy(Math.pow(10,36)).toFixed(2);return _context40.abrupt(\"return\",circulating);case 26:case\"end\":return _context40.stop();}}},_callee40);}));return function getCirculatingSupply(_x134){return _ref40.apply(this,arguments);};}();export var getLastRebaseTimestamp=/*#__PURE__*/function(){var _ref41=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee41(yam){var lastTimestamp;return _regeneratorRuntime.wrap(function _callee41$(_context41){while(1){switch(_context41.prev=_context41.next){case 0:_context41.prev=0;_context41.t0=yam;_context41.next=4;return yam.contracts.rebaser.methods.lastRebaseTimestampSec().call();case 4:_context41.t1=_context41.sent;lastTimestamp=_context41.t0.toBigN.call(_context41.t0,_context41.t1).toNumber();return _context41.abrupt(\"return\",lastTimestamp);case 9:_context41.prev=9;_context41.t2=_context41[\"catch\"](0);console.log(_context41.t2);case 12:case\"end\":return _context41.stop();}}},_callee41,null,[[0,9]]);}));return function getLastRebaseTimestamp(_x135){return _ref41.apply(this,arguments);};}();export var delegate=/*#__PURE__*/function(){var _ref42=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee43(yam,account,onTxHash){return _regeneratorRuntime.wrap(function _callee43$(_context43){while(1){switch(_context43.prev=_context43.next){case 0:return _context43.abrupt(\"return\",yam.contracts.yamV3.methods.delegate(account).send({from:account,gas:150000},/*#__PURE__*/function(){var _ref43=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee42(error,txHash){var status;return _regeneratorRuntime.wrap(function _callee42$(_context42){while(1){switch(_context42.prev=_context42.next){case 0:if(!error){_context42.next=4;break;}onTxHash&&onTxHash(\"\");console.log(\"Delegate error\",error);return _context42.abrupt(\"return\",false);case 4:onTxHash&&onTxHash(txHash);_context42.next=7;return waitTransaction(yam.web3.eth,txHash);case 7:status=_context42.sent;if(status){_context42.next=11;break;}console.log(\"Delegate transaction failed.\");return _context42.abrupt(\"return\",false);case 11:return _context42.abrupt(\"return\",true);case 12:case\"end\":return _context42.stop();}}},_callee42);}));return function(_x139,_x140){return _ref43.apply(this,arguments);};}()));case 1:case\"end\":return _context43.stop();}}},_callee43);}));return function delegate(_x136,_x137,_x138){return _ref42.apply(this,arguments);};}();export var didDelegate=/*#__PURE__*/function(){var _ref44=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee44(yam,account){return _regeneratorRuntime.wrap(function _callee44$(_context44){while(1){switch(_context44.prev=_context44.next){case 0:_context44.next=2;return yam.contracts.yamV3.methods.delegates(account).call();case 2:_context44.t0=_context44.sent;_context44.t1=account;return _context44.abrupt(\"return\",_context44.t0===_context44.t1);case 5:case\"end\":return _context44.stop();}}},_callee44);}));return function didDelegate(_x141,_x142){return _ref44.apply(this,arguments);};}();export var vote=/*#__PURE__*/function(){var _ref45=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee46(yam,proposal,side,account,onTxHash){return _regeneratorRuntime.wrap(function _callee46$(_context46){while(1){switch(_context46.prev=_context46.next){case 0:return _context46.abrupt(\"return\",yam.contracts.gov2.methods.castVote(proposal,side).send({from:account,gas:130000},/*#__PURE__*/function(){var _ref46=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee45(error,txHash){var status;return _regeneratorRuntime.wrap(function _callee45$(_context45){while(1){switch(_context45.prev=_context45.next){case 0:if(!error){_context45.next=4;break;}onTxHash&&onTxHash(\"\");console.log(\"Vote error\",error);return _context45.abrupt(\"return\",false);case 4:onTxHash&&onTxHash(txHash);_context45.next=7;return waitTransaction(yam.web3.eth,txHash);case 7:status=_context45.sent;if(status){_context45.next=11;break;}console.log(\"Vote transaction failed.\");return _context45.abrupt(\"return\",false);case 11:return _context45.abrupt(\"return\",true);case 12:case\"end\":return _context45.stop();}}},_callee45);}));return function(_x148,_x149){return _ref46.apply(this,arguments);};}()));case 1:case\"end\":return _context46.stop();}}},_callee46);}));return function vote(_x143,_x144,_x145,_x146,_x147){return _ref45.apply(this,arguments);};}();var stateMap={0:\"Pending\",1:\"Active\",2:\"Canceled\",3:\"Defeated\",4:\"Succeeded\",5:\"Queued\",6:\"Expired\",7:\"Executed\"};export var getProposals=/*#__PURE__*/function(){var _ref47=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee47(yam){var BASE24,v1Proposals,proposals,v1Descriptions,i,id,targets,j,sigs,_j,ins,_j2,abi_types,result,fr,k,proposal,fv,av,more,v2Proposals,_i,_id,_targets,_j3,_sigs,_j4,_ins,_j5,_abi_types,_result,_fr,_k,_proposal,_fv,_av,_more;return _regeneratorRuntime.wrap(function _callee47$(_context47){while(1){switch(_context47.prev=_context47.next){case 0:BASE24=new BigNumber(10).pow(24);_context47.next=3;return yam.contracts.gov.getPastEvents(\"ProposalCreated\",{fromBlock:10887059,toBlock:10926022});case 3:v1Proposals=_context47.sent;proposals=[];v1Descriptions=[];i=0;case 7:if(!(i<v1Proposals.length)){_context47.next=43;break;}id=v1Proposals[i][\"returnValues\"][\"id\"];targets=[];for(j=0;j<v1Proposals[i][\"returnValues\"][\"targets\"].length;j++){if(yam.contracts.names[v1Proposals[i][\"returnValues\"][\"targets\"][j]]){targets.push(yam.contracts.names[v1Proposals[i][\"returnValues\"][\"targets\"][j]]);}else{targets.push(v1Proposals[i][\"returnValues\"][\"targets\"][j]);}}sigs=[];for(_j=0;_j<v1Proposals[i][\"returnValues\"][\"signatures\"].length;_j++){if(yam.contracts.names[v1Proposals[i][\"returnValues\"][\"signatures\"][_j]]){sigs.push(yam.contracts.names[v1Proposals[i][\"returnValues\"][\"signatures\"][_j]]);}else{sigs.push(v1Proposals[i][\"returnValues\"][\"signatures\"][_j]);}}ins=[];for(_j2=0;_j2<v1Proposals[i][\"returnValues\"][\"calldatas\"].length;_j2++){abi_types=v1Proposals[i][\"returnValues\"][\"signatures\"][_j2].split(\"(\")[1].split(\")\").slice(0,-1)[0].split(\",\");result=yam.web3.eth.abi.decodeParameters(abi_types,v1Proposals[i][\"returnValues\"][\"calldatas\"][_j2]);fr=[];for(k=0;k<result.__length__;k++){fr.push(result[k.toString()]);}ins.push(fr);}_context47.next=17;return yam.contracts.gov.methods.proposals(id).call();case 17:proposal=_context47.sent;fv=new BigNumber(proposal[\"forVotes\"]).div(BASE24);av=new BigNumber(proposal[\"againstVotes\"]).div(BASE24);more=void 0;if(knownSnapshots[v1Proposals[i][\"transactionHash\"]]){more=knownSnapshots[v1Proposals[i][\"transactionHash\"]];}_context47.t0=proposals;_context47.t1=v1Proposals[i][\"returnValues\"][\"description\"];_context47.next=26;return yam.contracts.gov.methods.state(id).call();case 26:_context47.t2=_context47.sent;_context47.t3=stateMap[_context47.t2];_context47.t4=targets;_context47.t5=sigs;_context47.t6=ins;_context47.t7=fv.toNumber();_context47.t8=av.toNumber();_context47.t9=id;_context47.t10=v1Proposals[i][\"returnValues\"][\"startBlock\"];_context47.t11=v1Proposals[i][\"returnValues\"][\"endBlock\"];_context47.t12=v1Proposals[i][\"transactionHash\"];_context47.t13=more;_context47.t14={gov:\"gov\",description:_context47.t1,state:_context47.t3,targets:_context47.t4,signatures:_context47.t5,inputs:_context47.t6,forVotes:_context47.t7,againstVotes:_context47.t8,id:_context47.t9,start:_context47.t10,end:_context47.t11,hash:_context47.t12,more:_context47.t13};_context47.t0.push.call(_context47.t0,_context47.t14);case 40:i++;_context47.next=7;break;case 43:_context47.next=45;return yam.contracts.gov2.getPastEvents(\"ProposalCreated\",{fromBlock:10926022,toBlock:\"latest\"});case 45:v2Proposals=_context47.sent;_i=0;case 47:if(!(_i<v2Proposals.length)){_context47.next=83;break;}_id=v2Proposals[_i][\"returnValues\"][\"id\"];_targets=[];for(_j3=0;_j3<v2Proposals[_i][\"returnValues\"][\"targets\"].length;_j3++){if(yam.contracts.names[v2Proposals[_i][\"returnValues\"][\"targets\"][_j3]]){_targets.push(yam.contracts.names[v2Proposals[_i][\"returnValues\"][\"targets\"][_j3]]);}else{_targets.push(v2Proposals[_i][\"returnValues\"][\"targets\"][_j3]);}}_sigs=[];for(_j4=0;_j4<v2Proposals[_i][\"returnValues\"][\"signatures\"].length;_j4++){if(yam.contracts.names[v2Proposals[_i][\"returnValues\"][\"signatures\"][_j4]]){_sigs.push(yam.contracts.names[v2Proposals[_i][\"returnValues\"][\"signatures\"][_j4]]);}else{_sigs.push(v2Proposals[_i][\"returnValues\"][\"signatures\"][_j4]);}}_ins=[];for(_j5=0;_j5<v2Proposals[_i][\"returnValues\"][\"calldatas\"].length;_j5++){_abi_types=v2Proposals[_i][\"returnValues\"][\"signatures\"][_j5].split(\"(\")[1].split(\")\").slice(0,-1)[0].split(\",\");_result=yam.web3.eth.abi.decodeParameters(_abi_types,v2Proposals[_i][\"returnValues\"][\"calldatas\"][_j5]);_fr=[];for(_k=0;_k<_result.__length__;_k++){_fr.push(_result[_k.toString()]);}_ins.push(_fr);}_context47.next=57;return yam.contracts.gov2.methods.proposals(_id).call();case 57:_proposal=_context47.sent;_fv=new BigNumber(_proposal[\"forVotes\"]).div(BASE24);_av=new BigNumber(_proposal[\"againstVotes\"]).div(BASE24);_more=void 0;if(knownSnapshots[v2Proposals[_i][\"transactionHash\"]]){_more=knownSnapshots[v2Proposals[_i][\"transactionHash\"]];}_context47.t15=proposals;_context47.t16=v2Proposals[_i][\"returnValues\"][\"description\"];_context47.next=66;return yam.contracts.gov2.methods.state(_id).call();case 66:_context47.t17=_context47.sent;_context47.t18=stateMap[_context47.t17];_context47.t19=_targets;_context47.t20=_sigs;_context47.t21=_ins;_context47.t22=_fv.toNumber();_context47.t23=_av.toNumber();_context47.t24=_id;_context47.t25=v2Proposals[_i][\"returnValues\"][\"startBlock\"];_context47.t26=v2Proposals[_i][\"returnValues\"][\"endBlock\"];_context47.t27=v2Proposals[_i][\"transactionHash\"];_context47.t28=_more;_context47.t29={gov:\"gov2\",description:_context47.t16,state:_context47.t18,targets:_context47.t19,signatures:_context47.t20,inputs:_context47.t21,forVotes:_context47.t22,againstVotes:_context47.t23,id:_context47.t24,start:_context47.t25,end:_context47.t26,hash:_context47.t27,more:_context47.t28};_context47.t15.push.call(_context47.t15,_context47.t29);case 80:_i++;_context47.next=47;break;case 83:return _context47.abrupt(\"return\",proposals);case 84:case\"end\":return _context47.stop();}}},_callee47);}));return function getProposals(_x150){return _ref47.apply(this,arguments);};}();export var getVotingPowers=/*#__PURE__*/function(){var _ref48=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee48(yam,proposals,account){var BASE24,powers,i,receipt,power,_receipt,_power;return _regeneratorRuntime.wrap(function _callee48$(_context48){while(1){switch(_context48.prev=_context48.next){case 0:BASE24=new BigNumber(10).pow(24);powers=[];i=0;case 3:if(!(i<proposals.length)){_context48.next=32;break;}if(!(proposals[i].gov==\"gov\")){_context48.next=18;break;}_context48.next=7;return yam.contracts.gov.methods.getReceipt(proposals[i].id,account).call();case 7:receipt=_context48.sent;power=new BigNumber(receipt[2]).div(BASE24).toNumber();if(!(power==0)){_context48.next=15;break;}_context48.t0=BigNumber;_context48.next=13;return yam.contracts.yamV3.methods.getPriorVotes(account,proposals[i].start).call();case 13:_context48.t1=_context48.sent;power=new _context48.t0(_context48.t1).div(BASE24).toNumber();case 15:powers.push({hash:proposals[i].hash,power:power,voted:receipt[0],side:receipt[1]});_context48.next=29;break;case 18:_context48.next=20;return yam.contracts.gov2.methods.getReceipt(proposals[i].id,account).call();case 20:_receipt=_context48.sent;_power=new BigNumber(_receipt[2]).div(BASE24).toNumber();if(!(_power==0)){_context48.next=28;break;}_context48.t2=BigNumber;_context48.next=26;return yam.contracts.yamV3.methods.getPriorVotes(account,proposals[i].start).call();case 26:_context48.t3=_context48.sent;_power=new _context48.t2(_context48.t3).div(BASE24).toNumber();case 28:powers.push({hash:proposals[i].hash,power:_power,voted:_receipt[0],side:_receipt[1]});case 29:i++;_context48.next=3;break;case 32:return _context48.abrupt(\"return\",powers);case 33:case\"end\":return _context48.stop();}}},_callee48);}));return function getVotingPowers(_x151,_x152,_x153){return _ref48.apply(this,arguments);};}();export var getCurrentVotingPower=/*#__PURE__*/function(){var _ref49=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee49(yam,account){var BASE24;return _regeneratorRuntime.wrap(function _callee49$(_context49){while(1){switch(_context49.prev=_context49.next){case 0:BASE24=new BigNumber(10).pow(24);_context49.t0=BigNumber;_context49.next=4;return yam.contracts.yamV3.methods.getCurrentVotes(account).call();case 4:_context49.t1=_context49.sent;return _context49.abrupt(\"return\",new _context49.t0(_context49.t1).dividedBy(BASE24).toNumber());case 6:case\"end\":return _context49.stop();}}},_callee49);}));return function getCurrentVotingPower(_x154,_x155){return _ref49.apply(this,arguments);};}();export var getVotes=/*#__PURE__*/function(){var _ref50=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee50(yam){var votesRaw;return _regeneratorRuntime.wrap(function _callee50$(_context50){while(1){switch(_context50.prev=_context50.next){case 0:_context50.t0=BigNumber;_context50.next=3;return yam.contracts.yam.methods.getCurrentVotes(\"0x683A78bA1f6b25E29fbBC9Cd1BFA29A51520De84\").call();case 3:_context50.t1=_context50.sent;votesRaw=new _context50.t0(_context50.t1).dividedBy(Math.pow(10,24));return _context50.abrupt(\"return\",votesRaw);case 6:case\"end\":return _context50.stop();}}},_callee50);}));return function getVotes(_x156){return _ref50.apply(this,arguments);};}();export var getScalingFactor=/*#__PURE__*/function(){var _ref51=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee51(yam){return _regeneratorRuntime.wrap(function _callee51$(_context51){while(1){switch(_context51.prev=_context51.next){case 0:_context51.t0=BigNumber;_context51.next=3;return yam.contracts.yamV3.methods.yamsScalingFactor().call();case 3:_context51.t1=_context51.sent;return _context51.abrupt(\"return\",new _context51.t0(_context51.t1));case 5:case\"end\":return _context51.stop();}}},_callee51);}));return function getScalingFactor(_x157){return _ref51.apply(this,arguments);};}();export var getDelegatedBalance=/*#__PURE__*/function(){var _ref52=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee52(yam,account){return _regeneratorRuntime.wrap(function _callee52$(_context52){while(1){switch(_context52.prev=_context52.next){case 0:_context52.t0=BigNumber;_context52.next=3;return yam.contracts.yam.methods.balanceOfUnderlying(account).call();case 3:_context52.t1=_context52.sent;return _context52.abrupt(\"return\",new _context52.t0(_context52.t1).dividedBy(Math.pow(10,24)));case 5:case\"end\":return _context52.stop();}}},_callee52);}));return function getDelegatedBalance(_x158,_x159){return _ref52.apply(this,arguments);};}();export var migrate=/*#__PURE__*/function(){var _ref53=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee53(yam,account){return _regeneratorRuntime.wrap(function _callee53$(_context53){while(1){switch(_context53.prev=_context53.next){case 0:return _context53.abrupt(\"return\",yam.contracts.yamV2migration.methods.migrate().send({from:account,gas:320000}));case 1:case\"end\":return _context53.stop();}}},_callee53);}));return function migrate(_x160,_x161){return _ref53.apply(this,arguments);};}();export var getMigrationEndTime=/*#__PURE__*/function(){var _ref54=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee54(yam){return _regeneratorRuntime.wrap(function _callee54$(_context54){while(1){switch(_context54.prev=_context54.next){case 0:_context54.t0=yam;_context54.next=3;return yam.contracts.yamV2migration.methods.startTime().call();case 3:_context54.t1=_context54.sent;return _context54.abrupt(\"return\",_context54.t0.toBigN.call(_context54.t0,_context54.t1).plus(yam.toBigN(86400*3)).toNumber());case 5:case\"end\":return _context54.stop();}}},_callee54);}));return function getMigrationEndTime(_x162){return _ref54.apply(this,arguments);};}();export var getV2Supply=/*#__PURE__*/function(){var _ref55=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee55(yam){return _regeneratorRuntime.wrap(function _callee55$(_context55){while(1){switch(_context55.prev=_context55.next){case 0:_context55.t0=BigNumber;_context55.next=3;return yam.contracts.yamV2.methods.totalSupply().call();case 3:_context55.t1=_context55.sent;return _context55.abrupt(\"return\",new _context55.t0(_context55.t1));case 5:case\"end\":return _context55.stop();}}},_callee55);}));return function getV2Supply(_x163){return _ref55.apply(this,arguments);};}();export var migrationStarted=/*#__PURE__*/function(){var _ref56=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee56(yam){var now,startTime,token_initialized,delegatorRewardsSet;return _regeneratorRuntime.wrap(function _callee56$(_context56){while(1){switch(_context56.prev=_context56.next){case 0:now=new Date().getTime()/1000;// get current time\n_context56.next=3;return yam.contracts.migrator.methods.startTime().call();case 3:startTime=_context56.sent;_context56.next=6;return yam.contracts.migrator.methods.token_initialized().call();case 6:token_initialized=_context56.sent;_context56.next=9;return yam.contracts.migrator.methods.delegatorRewardsSet().call();case 9:delegatorRewardsSet=_context56.sent;if(!(now>=startTime&&token_initialized&&delegatorRewardsSet)){_context56.next=12;break;}return _context56.abrupt(\"return\",true);case 12:return _context56.abrupt(\"return\",false);case 13:case\"end\":return _context56.stop();}}},_callee56);}));return function migrationStarted(_x164){return _ref56.apply(this,arguments);};}();var yamToFragment=/*#__PURE__*/function(){var _ref57=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee57(yam,amount){var BASE24,scalingFactor;return _regeneratorRuntime.wrap(function _callee57$(_context57){while(1){switch(_context57.prev=_context57.next){case 0:BASE24=new BigNumber(10).pow(24);_context57.t0=BigNumber;_context57.next=4;return yam.contracts.yamV3.methods.yamsScalingFactor().call();case 4:_context57.t1=_context57.sent;scalingFactor=new _context57.t0(_context57.t1);return _context57.abrupt(\"return\",amount.multipliedBy(scalingFactor).dividedBy(BASE24));case 7:case\"end\":return _context57.stop();}}},_callee57);}));return function yamToFragment(_x165,_x166){return _ref57.apply(this,arguments);};}();export var currVested=/*#__PURE__*/function(){var _ref58=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee58(yam,account){var BASE,vested,amt;return _regeneratorRuntime.wrap(function _callee58$(_context58){while(1){switch(_context58.prev=_context58.next){case 0:BASE=new BigNumber(10).pow(18);_context58.t0=BigNumber;_context58.next=4;return yam.contracts.migrator.methods.vested(account).call();case 4:_context58.t1=_context58.sent;vested=new _context58.t0(_context58.t1);_context58.next=8;return yamToFragment(yam,vested);case 8:amt=_context58.sent;return _context58.abrupt(\"return\",amt.dividedBy(BASE));case 10:case\"end\":return _context58.stop();}}},_callee58);}));return function currVested(_x167,_x168){return _ref58.apply(this,arguments);};}();export var currUnclaimedDelegatorRewards=/*#__PURE__*/function(){var _ref59=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee59(yam,account){var BASE,unclaimed,amt;return _regeneratorRuntime.wrap(function _callee59$(_context59){while(1){switch(_context59.prev=_context59.next){case 0:BASE=new BigNumber(10).pow(18);/*\n  let start = new BigNumber(1600444800);\n  let duration = new BigNumber(90 * 86400);\n  let now = new BigNumber(new Date().getTime() / 1000);\n  let percDone = now.minus(start).dividedBy(duration);\n  if (percDone.gt(1)) {\n    percDone = new BigNumber(1)\n  }\n  */ //let totalVesting = new BigNumber(await yam.contracts.migrator.methods.delegator_vesting(account).call());\n//let claimed = new BigNumber(await yam.contracts.migrator.methods.delegator_claimed(account).call());\n//let unclaimed = ((totalVesting.multipliedBy(percDone)).minus(claimed));\n_context59.t0=BigNumber;_context59.next=4;return yam.contracts.strneth_pool.methods.earned(account).call();case 4:_context59.t1=_context59.sent;unclaimed=new _context59.t0(_context59.t1);_context59.next=8;return yamToFragment(yam,unclaimed);case 8:amt=_context59.sent;return _context59.abrupt(\"return\",amt.dividedBy(BASE));case 10:case\"end\":return _context59.stop();}}},_callee59);}));return function currUnclaimedDelegatorRewards(_x169,_x170){return _ref59.apply(this,arguments);};}();export var currUnclaimedMigratorVesting=/*#__PURE__*/function(){var _ref60=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee60(yam,account){var BASE,BASE24,start,duration,now,percDone,totalVesting,claimed,unclaimed,amt;return _regeneratorRuntime.wrap(function _callee60$(_context60){while(1){switch(_context60.prev=_context60.next){case 0:BASE=new BigNumber(10).pow(18);BASE24=new BigNumber(10).pow(24);start=new BigNumber(1600444800);duration=new BigNumber(30*86400);now=new BigNumber(new Date().getTime()/1000);percDone=now.minus(start).dividedBy(duration);if(percDone.gt(1)){percDone=new BigNumber(1);}_context60.t0=BigNumber;_context60.next=10;return yam.contracts.migrator.methods.vesting(account).call();case 10:_context60.t1=_context60.sent;totalVesting=new _context60.t0(_context60.t1);_context60.t2=BigNumber;_context60.next=15;return yam.contracts.migrator.methods.claimed(account).call();case 15:_context60.t3=_context60.sent;claimed=new _context60.t2(_context60.t3);unclaimed=totalVesting.multipliedBy(percDone).minus(claimed);_context60.next=20;return yamToFragment(yam,unclaimed);case 20:amt=_context60.sent;return _context60.abrupt(\"return\",amt.dividedBy(BASE));case 22:case\"end\":return _context60.stop();}}},_callee60);}));return function currUnclaimedMigratorVesting(_x171,_x172){return _ref60.apply(this,arguments);};}();export var delegatorRewards=/*#__PURE__*/function(){var _ref61=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee61(yam,account){var BASE,BASE24,rewards,amt;return _regeneratorRuntime.wrap(function _callee61$(_context61){while(1){switch(_context61.prev=_context61.next){case 0:BASE=new BigNumber(10).pow(18);BASE24=new BigNumber(10).pow(24);_context61.t0=BigNumber;_context61.next=5;return yam.contracts.migrator.methods.delegator_vesting(account).call();case 5:_context61.t1=_context61.sent;rewards=new _context61.t0(_context61.t1);_context61.next=9;return yamToFragment(yam,rewards);case 9:amt=_context61.sent;return _context61.abrupt(\"return\",amt.dividedBy(BASE));case 11:case\"end\":return _context61.stop();}}},_callee61);}));return function delegatorRewards(_x173,_x174){return _ref61.apply(this,arguments);};}();export var migrateV3=/*#__PURE__*/function(){var _ref62=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee63(yam,account,onTxHash){return _regeneratorRuntime.wrap(function _callee63$(_context63){while(1){switch(_context63.prev=_context63.next){case 0:_context63.next=2;return yam.contracts.migrator.methods.migrate().send({from:account,gas:200000},/*#__PURE__*/function(){var _ref63=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee62(error,txHash){var status;return _regeneratorRuntime.wrap(function _callee62$(_context62){while(1){switch(_context62.prev=_context62.next){case 0:if(!error){_context62.next=4;break;}onTxHash&&onTxHash(\"\");console.log(\"Migration error\",error);return _context62.abrupt(\"return\",false);case 4:onTxHash&&onTxHash(txHash);_context62.next=7;return waitTransaction(yam.web3.eth,txHash);case 7:status=_context62.sent;if(status){_context62.next=11;break;}console.log(\"Migration transaction failed.\");return _context62.abrupt(\"return\",false);case 11:return _context62.abrupt(\"return\",true);case 12:case\"end\":return _context62.stop();}}},_callee62);}));return function(_x178,_x179){return _ref63.apply(this,arguments);};}());case 2:return _context63.abrupt(\"return\",_context63.sent);case 3:case\"end\":return _context63.stop();}}},_callee63);}));return function migrateV3(_x175,_x176,_x177){return _ref62.apply(this,arguments);};}();export var claimVested=/*#__PURE__*/function(){var _ref64=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee64(yam,account,onTxHash){return _regeneratorRuntime.wrap(function _callee64$(_context64){while(1){switch(_context64.prev=_context64.next){case 0:_context64.next=2;return yam.contracts.migrator.methods.claimVested().send({from:account,gas:140000});case 2:return _context64.abrupt(\"return\",_context64.sent);case 3:case\"end\":return _context64.stop();}}},_callee64);}));return function claimVested(_x180,_x181,_x182){return _ref64.apply(this,arguments);};}();var sleep=function sleep(ms){return new Promise(function(resolve){return setTimeout(resolve,ms);});};export var waitTransaction=/*#__PURE__*/function(){var _ref65=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee65(provider,txHash){var web3,txReceipt,r;return _regeneratorRuntime.wrap(function _callee65$(_context65){while(1){switch(_context65.prev=_context65.next){case 0:web3=new Web3(provider);txReceipt=null;case 2:if(!(txReceipt===null)){_context65.next=11;break;}_context65.next=5;return web3.eth.getTransactionReceipt(txHash);case 5:r=_context65.sent;txReceipt=r;_context65.next=9;return sleep(2000);case 9:_context65.next=2;break;case 11:return _context65.abrupt(\"return\",txReceipt.status);case 12:case\"end\":return _context65.stop();}}},_callee65);}));return function waitTransaction(_x183,_x184){return _ref65.apply(this,arguments);};}();","map":null,"metadata":{},"sourceType":"module"}