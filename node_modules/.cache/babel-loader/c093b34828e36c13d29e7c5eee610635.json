{"ast":null,"code":"import _taggedTemplateLiteral from\"/Users/hienle/Documents/GitHub/comfortNFT/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";import _slicedToArray from\"/Users/hienle/Documents/GitHub/comfortNFT/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";function _templateObject2(){var data=_taggedTemplateLiteral([\"\\n  display: flex;\\n  flex-flow: row nowrap;\\n  justify-content: space-between;\\n  > div {\\n    margin: 0 0.25rem;\\n  }\\n\"]);_templateObject2=function _templateObject2(){return data;};return data;}function _templateObject(){var data=_taggedTemplateLiteral([\"\\n  font-size: 18px;\\n  font-weight: 600;\\n\"]);_templateObject=function _templateObject(){return data;};return data;}import React,{useCallback,useEffect,useMemo,useState}from\"react\";import{Spacer}from\"react-neu\";import styled from\"styled-components\";import useApproval from\"hooks/useApproval\";import{getAddresses}from\"constants/tokenAddresses\";import useStrainNfts from\"hooks/useStrainNfts\";import{useWallet}from\"use-wallet\";import{MIN_LP_AMOUNTS,MIN_LP_AMOUNTS_DISPLAY,MIN_STRN_GEN_VALUE,PoolIds,POOL_NAMES}from\"constants/poolValues\";import NamedGeneratingModal from\"views/Modals/NamedGeneratingModal\";import BigNumber from\"bignumber.js\";import numeral from\"numeral\";import Label from\"components/Label\";import StyledPrimaryButton from\"views/Common/StyledButton\";import useBalances from\"hooks/useBalances\";var GenerateNftButton=function GenerateNftButton(_ref){var poolId=_ref.poolId,walletBalance=_ref.walletBalance;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),generateModalIsOpen=_useState2[0],setGenerateModalIsOpen=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),canGenerate=_useState4[0],setCanGenerate=_useState4[1];var _useStrainNfts=useStrainNfts(),setConfirmTxModalIsOpen=_useStrainNfts.setConfirmTxModalIsOpen,isCreating=_useStrainNfts.isCreating,onCreateNft=_useStrainNfts.onCreateNft;var _useBalances=useBalances(),strnTokenBalance=_useBalances.strnTokenBalance;var _useWallet=useWallet(),status=_useWallet.status;var poolName=useMemo(function(){return POOL_NAMES[Number(poolId)];},[poolId]);var minAmountLpTokens=useMemo(function(){return MIN_LP_AMOUNTS[Number(poolId)];},[poolId]);var getLpTokenAddress=function getLpTokenAddress(){if(poolId===PoolIds.STRN_ETH)return getAddresses().strnLPTokenAddress;return getAddresses().strnXiotLPTokenAddress;};var _useApproval=useApproval(getLpTokenAddress(),getAddresses().strainNFTCrafterAddress,function(){return setConfirmTxModalIsOpen(false);}),isApproved=_useApproval.isApproved,isApproving=_useApproval.isApproving,onApprove=_useApproval.onApprove;var _useApproval2=useApproval(getAddresses().strnTokenAddress,getAddresses().strainNFTCrafterAddress,function(){return setConfirmTxModalIsOpen(false);}),isApprovedStrn=_useApproval2.isApproved,isApprovingStrn=_useApproval2.isApproving,onApproveStrn=_useApproval2.onApprove;var handleApprove=useCallback(function(){setConfirmTxModalIsOpen(true);onApprove();},[onApprove,setConfirmTxModalIsOpen]);var handleApproveStrn=useCallback(function(){setConfirmTxModalIsOpen(true);onApproveStrn();},[onApprove,setConfirmTxModalIsOpen]);var handleGenerateClick=useCallback(function(){setGenerateModalIsOpen(true);},[setGenerateModalIsOpen]);var handleOnGenerate=function handleOnGenerate(amount,name){onCreateNft(poolId,amount,name);handleDismissGenerateModal();};var handleDismissGenerateModal=useCallback(function(){setGenerateModalIsOpen(false);},[setGenerateModalIsOpen]);useEffect(function(){var hasEnoughStrn=strnTokenBalance?strnTokenBalance===null||strnTokenBalance===void 0?void 0:strnTokenBalance.gte(MIN_STRN_GEN_VALUE):false;if(!minAmountLpTokens||!walletBalance||!hasEnoughStrn){setCanGenerate(false);}else if(walletBalance&&new BigNumber(walletBalance).gte(new BigNumber(minAmountLpTokens))){setCanGenerate(true);}},[walletBalance,poolId,strnTokenBalance]);var formattedLPBalance=useMemo(function(){if(walletBalance){return poolId===PoolIds.STRN_ETH?numeral(walletBalance).format(\"0.00a\"):walletBalance.toFixed(8);}else{return\"--\";}},[walletBalance,poolId]);var GenerateButton=useMemo(function(){if(status!==\"connected\"){return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(StyledPrimaryButton,{disabled:true,full:true,text:\"Not Connected\",variant:\"secondary\"}));}if(walletBalance===undefined){return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(StyledPrimaryButton,{disabled:true,full:true,text:\"Loading ...\",variant:\"secondary\"}));}if(!canGenerate){return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Spacer,{size:\"sm\"}),/*#__PURE__*/React.createElement(StyledPrimaryButton,{disabled:true,full:true,text:\"Insufficient LP or STRN balance\",variant:\"secondary\"}));}if(isCreating){return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(StyledPrimaryButton,{disabled:true,full:true,text:\"Generating...\",variant:\"secondary\"}));}if(!isApproved||!isApprovedStrn){// disable generation\nreturn/*#__PURE__*/React.createElement(StyledButtonRow,null,/*#__PURE__*/React.createElement(StyledPrimaryButton,{onClick:handleApprove,disabled:isApproved,full:true,size:\"sm\",text:isApproving?\"Approving ...\":!isApproved?\"Approve Generating\":\"Approved\",variant:isApproving||status!==\"connected\"?\"secondary\":\"default\"}),/*#__PURE__*/React.createElement(StyledPrimaryButton,{onClick:handleApproveStrn,disabled:isApprovedStrn,full:true,size:\"sm\",text:isApprovingStrn?\"Approving ...\":!isApprovedStrn?\"Approve STRN Fee\":\"Approved\",variant:isApprovingStrn||status!==\"connected\"?\"secondary\":\"default\"}));}if(isApproved&&isApprovedStrn){return/*#__PURE__*/React.createElement(React.Fragment,null,canGenerate&&/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(StyledPrimaryButton,{full:true,onClick:handleGenerateClick,text:\"wrap \".concat(poolName,\" LP\")})));}},[handleGenerateClick,isApproved,isApproving,isApprovedStrn,isApprovingStrn,isApprovedStrn,isCreating,handleApprove,status]);return/*#__PURE__*/React.createElement(React.Fragment,null,status!==\"connected\"&&/*#__PURE__*/React.createElement(Spacer,{size:\"sm\"}),/*#__PURE__*/React.createElement(\"div\",null,poolName,\" LP: \",/*#__PURE__*/React.createElement(StyledValue,null,formattedLPBalance)),/*#__PURE__*/React.createElement(Label,{text:\"Min: \".concat(String(MIN_LP_AMOUNTS_DISPLAY[Number(poolId)]),\" \").concat(poolName,\" LP\")}),/*#__PURE__*/React.createElement(Spacer,{size:\"sm\"}),GenerateButton,/*#__PURE__*/React.createElement(NamedGeneratingModal,{isOpen:generateModalIsOpen,onDismiss:handleDismissGenerateModal,onGenerate:handleOnGenerate,label:poolName,fullBalance:walletBalance,minAmount:minAmountLpTokens,poolId:poolId}));};var StyledValue=styled.span(_templateObject());var StyledButtonRow=styled.div(_templateObject2());export default GenerateNftButton;","map":null,"metadata":{},"sourceType":"module"}