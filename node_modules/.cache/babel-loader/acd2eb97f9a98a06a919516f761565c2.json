{"ast":null,"code":"import _regeneratorRuntime from\"/Users/hienle/Documents/GitHub/comfortNFT/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/hienle/Documents/GitHub/comfortNFT/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/hienle/Documents/GitHub/comfortNFT/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useCallback,useEffect,useState}from'react';import BigNumber from'bignumber.js';import{useWallet}from'use-wallet';import ConfirmTransactionModal from'components/ConfirmTransactionModal';import{getAddresses}from'constants/tokenAddresses';import useYam from'hooks/useYam';import{getEarned,harvest,redeem,stake,unstake}from'yam-sdk/utils';import Context from'./Context';import{setItemValue}from'utils';var addresses=getAddresses();var Provider=function Provider(_ref){var children=_ref.children;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),confirmTxModalIsOpen=_useState2[0],setConfirmTxModalIsOpen=_useState2[1];var _useState3=useState([false,false]),_useState4=_slicedToArray(_useState3,2),isHarvesting=_useState4[0],setIsHarvesting=_useState4[1];var _useState5=useState([false,false]),_useState6=_slicedToArray(_useState5,2),isRedeeming=_useState6[0],setIsRedeeming=_useState6[1];var _useState7=useState([false,false]),_useState8=_slicedToArray(_useState7,2),isStaking=_useState8[0],setIsStaking=_useState8[1];var _useState9=useState([false,false]),_useState10=_slicedToArray(_useState9,2),isUnstaking=_useState10[0],setIsUnstaking=_useState10[1];var _useState11=useState(),_useState12=_slicedToArray(_useState11,2),earnedStrnPoolBalances=_useState12[0],setEarnedStrnPoolBalance=_useState12[1];var _useState13=useState(),_useState14=_slicedToArray(_useState13,2),earnedXiotPoolBalances=_useState14[0],setEarnedXiotPoolBalance=_useState14[1];var yam=useYam();var _useWallet=useWallet(),account=_useWallet.account;var lpAddresses=[addresses.strnLPTokenAddress,addresses.strnXiotLPTokenAddress];var getPoolLPAddress=function getPoolLPAddress(poolId){return lpAddresses[Number(poolId)];};var incentivizerAddresses=[addresses.strnEthIncAddress,addresses.strnXiotPoolAddress];var getIncentivizerAddress=function getIncentivizerAddress(poolId){return incentivizerAddresses[Number(poolId)];};var getSetRewardsBalanceMethod=function getSetRewardsBalanceMethod(){var poolId=arguments.length>0&&arguments[0]!==undefined?arguments[0]:\"0\";return[setEarnedStrnPoolBalance,setEarnedXiotPoolBalance][Number(poolId)];};var getIncContract=function getIncContract(poolId){if(yam){if(poolId===\"0\"){return yam.contracts.strneth_pool;}return yam.contracts.strnxiot_pool;}};var getEarnedBalances=function getEarnedBalances(poolId){return[earnedStrnPoolBalances,earnedXiotPoolBalances][Number(poolId)]||new BigNumber(0);};var fetchEarnedBalance=useCallback(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(poolId){var balance;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(!account||!yam)){_context.next=2;break;}return _context.abrupt(\"return\");case 2:_context.next=4;return getEarned(yam,getIncContract(poolId),account);case 4:balance=_context.sent;getSetRewardsBalanceMethod(poolId)(balance);case 6:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref2.apply(this,arguments);};}(),[account,setEarnedStrnPoolBalance,setEarnedXiotPoolBalance,yam]);var fetchBalances=useCallback(/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(poolId){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:fetchEarnedBalance(poolId);case 1:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref3.apply(this,arguments);};}(),[fetchEarnedBalance]);var handleHarvest=useCallback(/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(poolId){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:if(yam){_context3.next=2;break;}return _context3.abrupt(\"return\");case 2:setConfirmTxModalIsOpen(true);setIsHarvesting(setItemValue(isHarvesting,poolId,true));_context3.next=6;return harvest(getIncContract(poolId),yam.web3.eth,account,function(){setConfirmTxModalIsOpen(false);}).catch(function(e){console.error(e);});case 6:setIsHarvesting(setItemValue(isHarvesting,poolId,false));case 7:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x3){return _ref4.apply(this,arguments);};}(),[account,setConfirmTxModalIsOpen,setIsHarvesting,yam]);var handleRedeem=useCallback(/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(poolId){return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:if(yam){_context4.next=2;break;}return _context4.abrupt(\"return\");case 2:setConfirmTxModalIsOpen(true);setIsRedeeming(setItemValue(isRedeeming,poolId,true));_context4.next=6;return redeem(getIncContract(poolId),yam.web3.eth,\"0\",account,function(){setConfirmTxModalIsOpen(false);}).catch(function(e){console.error(e);setIsRedeeming(setItemValue(isRedeeming,poolId,false));});case 6:setIsRedeeming(setItemValue(isRedeeming,poolId,false));case 7:case\"end\":return _context4.stop();}}},_callee4);}));return function(_x4){return _ref5.apply(this,arguments);};}(),[account,setConfirmTxModalIsOpen,setIsRedeeming,yam]);var handleStake=useCallback(/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(poolId,amount){return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:if(yam){_context5.next=2;break;}return _context5.abrupt(\"return\");case 2:setConfirmTxModalIsOpen(true);setIsStaking(setItemValue(isStaking,poolId,true));_context5.next=6;return stake(getIncContract(poolId),yam.web3.eth,\"0\",amount,account,function(){setConfirmTxModalIsOpen(false);}).catch(function(e){console.error(e);setIsStaking(setItemValue(isStaking,poolId,false));});case 6:setIsStaking(setItemValue(isStaking,poolId,false));case 7:case\"end\":return _context5.stop();}}},_callee5);}));return function(_x5,_x6){return _ref6.apply(this,arguments);};}(),[account,setConfirmTxModalIsOpen,setIsStaking,yam]);var handleUnstake=useCallback(/*#__PURE__*/function(){var _ref7=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(poolId,amount){return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:if(yam){_context6.next=2;break;}return _context6.abrupt(\"return\");case 2:setConfirmTxModalIsOpen(true);setIsUnstaking(setItemValue(isUnstaking,poolId,true));_context6.next=6;return unstake(getIncContract(poolId),yam.web3.eth,\"0\",amount,account,function(){setConfirmTxModalIsOpen(false);}).catch(function(e){console.error(e);setIsUnstaking(setItemValue(isUnstaking,poolId,false));});case 6:setIsUnstaking(setItemValue(isUnstaking,poolId,false));case 7:case\"end\":return _context6.stop();}}},_callee6);}));return function(_x7,_x8){return _ref7.apply(this,arguments);};}(),[account,setConfirmTxModalIsOpen,setIsUnstaking,yam]);useEffect(function(){fetchBalances(\"0\");fetchBalances(\"1\");var refreshInterval=setInterval(function(){fetchBalances(\"0\");fetchBalances(\"1\");},10000);return function(){return clearInterval(refreshInterval);};},[fetchBalances]);return/*#__PURE__*/React.createElement(Context.Provider,{value:{getPoolLPAddress:getPoolLPAddress,setConfirmTxModalIsOpen:setConfirmTxModalIsOpen,getEarnedBalances:getEarnedBalances,isHarvesting:isHarvesting,isRedeeming:isRedeeming,isStaking:isStaking,isUnstaking:isUnstaking,onHarvest:handleHarvest,onRedeem:handleRedeem,onStake:handleStake,onUnstake:handleUnstake,getIncentivizerAddress:getIncentivizerAddress}},children,/*#__PURE__*/React.createElement(ConfirmTransactionModal,{isOpen:confirmTxModalIsOpen}));};export default Provider;","map":null,"metadata":{},"sourceType":"module"}